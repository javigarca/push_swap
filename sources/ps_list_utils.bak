#include "push_swap.h"

t_stack	*ft_build_stack(int *dt)
{
	t_stack *node;
	t_stack *first_node;
	t_stack *last_node;

	node = (t_stack *) malloc(sizeof (t_stack));
	if (!node)
		ft_exit_error(4);
	node->data = dt[0];
	node->next = node;
	node->prev = node;
	first_node = node;
	ft_load_nodes(dt, &first_node, &last_node, &node);
	last_node = node;
	node = node->next;
    node->prev = last_node;
    return (node);
}

void	ft_load_nodes(int *dt, t_stack *f_node, t_stack *l_node, t_stack *node)
{
	t_stack *next_node;
	int	i;

	i = 1;
	while (dt[i])
	{
		next_node = (t_stack *) malloc(sizeof (t_stack));
		if (!next_node)
			ft_exit_error(4);
		next_node->data = dt[i];
		next_node->next = f_node;
        node->next = next_node;
        l_node = node;
        node = next_node;
        node->prev = l_node;
		i++;
	}
}

NODO *CrearNodo(int dato);
int InsertarInicio(NODO **cabeza, int dato);
int InsertarFinal(NODO **cabeza, int dato);
void ImprimirLista(NODO *cabeza);
int EliminarNodo(NODO **cabeza, int dato);


int main()
{
    NODO *cabeza = NULL;

    InsertarInicio(&cabeza, 1);
    InsertarInicio(&cabeza, 2);
    InsertarFinal(&cabeza, 3);
    InsertarFinal(&cabeza, 4);
    EliminarNodo(&cabeza, 4);
    ImprimirLista(cabeza);
    system("pause>nul");

    return 0;
}

//FunciÛn para eliminar un nodo de la lista
int EliminarNodo(NODO **cabeza, int dato)
{
    NODO *actual = *cabeza, *ant = NULL, *sig = NULL;

    while(actual != NULL)
    {
        if(actual->dato == dato)
        {
            if( actual == *cabeza)
            {
                *cabeza = actual->siguiente;
                if( actual->siguiente != NULL)
                    actual->siguiente->anterior = NULL;
            }
            else if( actual->siguiente == NULL)
            {
                ant = actual->anterior;
                actual->anterior = NULL;
                ant->siguiente = NULL;
            }
            else
            {
                ant = actual->anterior;
                actual->anterior = NULL;
                sig = actual->siguiente;
                actual->siguiente = NULL;
                ant->siguiente = sig;
                sig->anterior = ant;
            }
            free(actual);
            return 1;
        }
        actual = actual->siguiente;
    }
    return 0;
}

//FunciÛn para insertar al final de la lista
int InsertarFinal(NODO **cabeza, int dato)
{
    NODO *nuevo = NULL, *nAux = *cabeza;

    nuevo = CrearNodo(dato);
    if (nuevo != NULL)
    {
        while(nAux->siguiente != NULL){ nAux = nAux->siguiente;}
        nuevo->anterior = nAux;
        nAux->siguiente = nuevo;
        return 1;
    }
    return 0;
}

//FunciÛn para imprimir la lista
void ImprimirLista(NODO *cabeza)
{
    NODO *nAux = cabeza;

    while(nAux != NULL)
    {
        printf("%d ", nAux->dato);
        nAux = nAux->siguiente;
    }
}

//FunciÛn para insertar al inicio de la lista
int InsertarInicio(NODO **cabeza, int dato)
{
    NODO *nuevo = NULL;

    nuevo = CrearNodo(dato);
    if (nuevo != NULL)
    {
        nuevo->siguiente = *cabeza;
        nuevo->anterior = NULL;
        if( *cabeza != NULL)
            (*cabeza)->anterior = nuevo;
        *cabeza = nuevo;
        return 1;
    }
    return 0;
}

//FunciÛn para crear un nuevo nodo
NODO *CrearNodo(int dato)
{
    NODO* nuevo = NULL;

    nuevo = (NODO*)malloc(sizeof(NODO));
    if( nuevo != NULL)
    {
        nuevo->dato = dato;
        nuevo->siguiente = NULL;
        nuevo->anterior = NULL;
    }
    return nuevo;
}

